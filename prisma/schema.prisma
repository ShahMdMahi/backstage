generator client {
  provider = "prisma-client"
  output   = "../lib/prisma"
}

datasource db {
  provider = "postgresql"
}

enum ROLE {
  SYSTEM_ADMIN
  SYSTEM_MANAGER
  SYSTEM_USER
  ACCOUNT_ADMIN
  ACCOUNT_MANAGER
  ACCOUNT_USER
  ARTIST
  USER
}

enum SESSION_DEVICE_TYPE {
  DESKTOP
  LAPTOP
  TABLET
  MOBILE
  OTHER
}

enum AUDIT_LOG_ACTION {
  // User Actions
  USER_REGISTERED
  USER_LOGGED_IN
  USER_LOGGED_OUT
  USER_RESEND_VERIFICATION
  USER_FORGOT_PASSWORD
  USER_RESET_PASSWORD
  USER_VERIFIED
  USER_SUSPENDED
  USER_APPROVED
  USER_PASSWORD_CHANGED
  USER_UPDATED
  USER_DELETED

  // Session Actions
  SESSION_CREATED
  SESSION_REVOKED
  SESSION_ACCESSED
}

enum AUDIT_LOG_ENTITY {
  USER
  SESSION
}

model User {
  // Primary Key
  id String @id @default(cuid())

  // Foreign Keys

  // Fields
  name     String
  email    String  @unique
  password String
  phone    String
  avatar   String?

  // Enums
  role ROLE @default(USER)

  // Relations
  sessions  Session[]
  auditLogs AuditLog[]

  // Timestamps
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  verifiedAt  DateTime?
  approvedAt  DateTime?
  suspendedAt DateTime?

  // Indexes & Constraints
}

model Session {
  // Primary Key
  id String @id @default(cuid())

  // Foreign Keys
  userId String

  // Fields
  token             String @unique
  userAgent         String
  ipAddress         String
  deviceFingerprint String
  metadata    Json?

  // Enums
  deviceType SESSION_DEVICE_TYPE @default(OTHER)

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  // Timestamps
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt
  expiresAt  DateTime
  revokedAt  DateTime?
  accessedAt DateTime?

  // Indexes & Constraints
}

model AuditLog {
  // Primary Key
  id String @id @default(cuid())

  // Foreign Keys
  userId String?

  // Fields
  entityId    String
  bySystem    Boolean @default(false)
  description String?
  metadata    Json?

  // Enums
  action AUDIT_LOG_ACTION
  entity AUDIT_LOG_ENTITY

  // Relations
  user User? @relation(fields: [userId], references: [id], onDelete: SetNull)

  // Timestamps
  createdAt DateTime @default(now())

  // Indexes & Constraints
}
