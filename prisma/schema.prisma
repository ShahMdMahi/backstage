generator client {
  provider = "prisma-client"
  output   = "../lib/prisma"
}

datasource db {
  provider = "postgresql"
}

enum ROLE {
  DEVELOPER
  SYSTEM_ADMIN
  USER
}

enum SESSION_DEVICE_TYPE {
  DESKTOP
  TABLET
  MOBILE
  CONSOLE
  EMBEDDED
  SMARTTV
  WEARABLE
  XR
  OTHER
}

enum WORKSPACE_ACCOUNT_TYPE {
  B2B
  LABEL
  ARTIST
}

enum WORKSPACE_ACCOUNT_STATUS {
  ACTIVE
  SUSPENDED
  CANCELLED
}

enum WORKSPACE_ACCOUNT_ACCESS_ROLE {
  ADMIN
  MANAGER
  ARTIST
  MEMBER
}

enum WORKSPACE_ACCOUNT_ACCESS_STATUS {
  ACTIVE
  SUSPENDED
}

enum AUDIT_LOG_ACTION {
  // User Actions
  USER_REGISTERED
  USER_LOGGED_IN
  USER_LOGGED_OUT
  USER_RESEND_VERIFICATION
  USER_FORGOT_PASSWORD
  USER_RESET_PASSWORD
  USER_VERIFIED
  USER_SUSPENDED
  USER_APPROVED
  USER_PASSWORD_CHANGED
  USER_UPDATED
  USER_DELETED

  // Session Actions
  SESSION_CREATED
  SESSION_REVOKED
  SESSION_ACCESSED

  // Workspace Account Actions
  WORKSPACE_ACCOUNT_CREATED
  WORKSPACE_ACCOUNT_UPDATED
  WORKSPACE_ACCOUNT_DELETED
  WORKSPACE_ACCOUNT_SUSPENDED
  WORKSPACE_ACCOUNT_REACTIVATED

  // Release Actions
  RELEASE_CREATED
  RELEASE_UPDATED
  RELEASE_DELETED

  // Track Actions
  TRACK_CREATED
  TRACK_UPDATED
  TRACK_DELETED

  // Video Actions
  VIDEO_CREATED
  VIDEO_UPDATED
  VIDEO_DELETED

  // Ringtone Actions
  RINGTONE_CREATED
  RINGTONE_UPDATED
  RINGTONE_DELETED

  // Artist Actions
  ARTIST_CREATED
  ARTIST_UPDATED
  ARTIST_DELETED

  // Performer Actions
  PERFORMER_CREATED
  PERFORMER_UPDATED
  PERFORMER_DELETED

  // Producer and Engineer Actions
  PRODUCER_AND_ENGINEER_CREATED
  PRODUCER_AND_ENGINEER_UPDATED
  PRODUCER_AND_ENGINEER_DELETED

  // Writer Actions
  WRITER_CREATED
  WRITER_UPDATED
  WRITER_DELETED

  // Publisher Actions
  PUBLISHER_CREATED
  PUBLISHER_UPDATED
  PUBLISHER_DELETED

  // Label Actions
  LABEL_CREATED
  LABEL_UPDATED
  LABEL_DELETED

  // Shared Workspace Account Access Actions
  SHARED_WORKSPACE_ACCOUNT_ACCESS_CREATED
  SHARED_WORKSPACE_ACCOUNT_ACCESS_UPDATED
  SHARED_WORKSPACE_ACCOUNT_ACCESS_SUSPENDED
  SHARED_WORKSPACE_ACCOUNT_ACCESS_REACTIVATED
  SHARED_WORKSPACE_ACCOUNT_ACCESS_DELETED

  // Transaction Actions
  TRANSACTION_CREATED
  TRANSACTION_UPDATED
  TRANSACTION_DELETED

  // Withdrawal Actions
  WITHDRAWAL_CREATED
  WITHDRAWAL_UPDATED
  WITHDRAWAL_DELETED
}

enum AUDIT_LOG_ENTITY {
  USER
  SESSION
  WORKSPACE_ACCOUNT
  RELEASE
  TRACK
  VIDEO
  RINGTONE
  ARTIST
  PERFORMER
  PRODUCER_AND_ENGINEER
  WRITER
  PUBLISHER
  LABEL
  SHARED_WORKSPACE_ACCOUNT_ACCESS
  TRANSACTION
  WITHDRAWAL
}

model User {
  // Primary Key
  id String @id @default(cuid())

  // Foreign Keys

  // Fields
  name     String
  email    String  @unique
  password String
  phone    String
  avatar   String?

  // Enums
  role ROLE @default(USER)

  // Relations
  sessions                         Session[]
  ownWorkspaceAccount              WorkspaceAccount?
  sharedWorkspaceAccountAccesses   SharedWorkspaceAccountAccess[] @relation("SharedWorkspaceAccountAccessUser")
  assignedWorkspaceAccountAccesses SharedWorkspaceAccountAccess[] @relation("SharedWorkspaceAccountAccessAssigner")
  auditLogs                        AuditLog[]

  // Timestamps
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  verifiedAt  DateTime?
  approvedAt  DateTime?
  suspendedAt DateTime?

  // Indexes & Constraints
}

model Session {
  // Primary Key
  id String @id @default(cuid())

  // Foreign Keys
  userId String

  // Fields
  token             String @unique
  userAgent         String
  ipAddress         String
  deviceFingerprint String
  metadata          Json?

  // Enums
  deviceType SESSION_DEVICE_TYPE @default(OTHER)

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  // Timestamps
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt
  expiresAt  DateTime
  revokedAt  DateTime?
  accessedAt DateTime?

  // Indexes & Constraints
  @@index([token])
  @@index([userId])
  @@index([expiresAt])
  @@index([revokedAt])
  @@index([accessedAt])
}

model WorkspaceAccount {
  // Primary Key
  id String @id @default(cuid())

  // Foreign Keys
  ownerId String @unique

  // Fields
  name        String
  legalName   String
  description String
  logo        String
  metadata    Json?

  // Enums
  type   WORKSPACE_ACCOUNT_TYPE
  status WORKSPACE_ACCOUNT_STATUS @default(ACTIVE)

  // Relations
  owner                 User                           @relation(fields: [ownerId], references: [id], onDelete: Cascade)
  sharedAccesses        SharedWorkspaceAccountAccess[]
  releases              Release[]
  tracks                Track[]
  videos                Video[]
  ringtones             Ringtone[]
  artists               Artist[]
  performers            Performer[]
  producersAndEngineers ProducerAndEngineer[]
  writers               Writer[]
  publishers            Publisher[]
  labels                Label[]

  // Timestamps
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt
  subscriptionStatsAt DateTime
  subscriptionEndsAt  DateTime

  // Indexes & Constraints
}

model Release {
  // Primary Key
  id String @id @default(cuid())

  // Foreign Keys
  workspaceAccountId String

  // Fields
  metadata Json?

  // Enums

  // Relations
  workspaceAccount             WorkspaceAccount               @relation(fields: [workspaceAccountId], references: [id], onDelete: Cascade)
  sharedWorkspaceAccountAccess SharedWorkspaceAccountAccess[]

  // Timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Indexes & Constraints
}

model Track {
  // Primary Key
  id String @id @default(cuid())

  // Foreign Keys
  workspaceAccountId String

  // Fields
  metadata Json?

  // Enums

  // Relations
  workspaceAccount             WorkspaceAccount               @relation(fields: [workspaceAccountId], references: [id], onDelete: Cascade)
  sharedWorkspaceAccountAccess SharedWorkspaceAccountAccess[]

  // Timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Indexes & Constraints
}

model Video {
  // Primary Key
  id String @id @default(cuid())

  // Foreign Keys
  workspaceAccountId String

  // Fields
  metadata Json?

  // Enums

  // Relations
  workspaceAccount             WorkspaceAccount               @relation(fields: [workspaceAccountId], references: [id], onDelete: Cascade)
  sharedWorkspaceAccountAccess SharedWorkspaceAccountAccess[]

  // Timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Indexes & Constraints
}

model Ringtone {
  // Primary Key
  id String @id @default(cuid())

  // Foreign Keys
  workspaceAccountId String

  // Fields
  metadata Json?

  // Enums

  // Relations
  workspaceAccount             WorkspaceAccount               @relation(fields: [workspaceAccountId], references: [id], onDelete: Cascade)
  sharedWorkspaceAccountAccess SharedWorkspaceAccountAccess[]

  // Timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Indexes & Constraints
}

model Artist {
  // Primary Key
  id String @id @default(cuid())

  // Foreign Keys
  workspaceAccountId String

  // Fields
  metadata Json?

  // Enums

  // Relations
  workspaceAccount             WorkspaceAccount               @relation(fields: [workspaceAccountId], references: [id], onDelete: Cascade)
  sharedWorkspaceAccountAccess SharedWorkspaceAccountAccess[]

  // Timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Indexes & Constraints
}

model Performer {
  // Primary Key
  id String @id @default(cuid())

  // Foreign Keys
  workspaceAccountId String

  // Fields
  metadata Json?

  // Enums

  // Relations
  workspaceAccount             WorkspaceAccount               @relation(fields: [workspaceAccountId], references: [id], onDelete: Cascade)
  sharedWorkspaceAccountAccess SharedWorkspaceAccountAccess[]

  // Timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Indexes & Constraints
}

model ProducerAndEngineer {
  // Primary Key
  id String @id @default(cuid())

  // Foreign Keys
  workspaceAccountId String

  // Fields
  metadata Json?

  // Enums

  // Relations
  workspaceAccount             WorkspaceAccount               @relation(fields: [workspaceAccountId], references: [id], onDelete: Cascade)
  sharedWorkspaceAccountAccess SharedWorkspaceAccountAccess[]

  // Timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Indexes & Constraints
}

model Writer {
  // Primary Key
  id String @id @default(cuid())

  // Foreign Keys
  workspaceAccountId String

  // Fields
  metadata Json?

  // Enums

  // Relations
  workspaceAccount             WorkspaceAccount               @relation(fields: [workspaceAccountId], references: [id], onDelete: Cascade)
  sharedWorkspaceAccountAccess SharedWorkspaceAccountAccess[]

  // Timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Indexes & Constraints
}

model Publisher {
  // Primary Key
  id String @id @default(cuid())

  // Foreign Keys
  workspaceAccountId String

  // Fields
  metadata Json?

  // Enums

  // Relations
  workspaceAccount             WorkspaceAccount               @relation(fields: [workspaceAccountId], references: [id], onDelete: Cascade)
  sharedWorkspaceAccountAccess SharedWorkspaceAccountAccess[]

  // Timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Indexes & Constraints
}

model Label {
  // Primary Key
  id String @id @default(cuid())

  // Foreign Keys
  workspaceAccountId String

  // Fields
  metadata Json?

  // Enums

  // Relations
  workspaceAccount             WorkspaceAccount               @relation(fields: [workspaceAccountId], references: [id], onDelete: Cascade)
  sharedWorkspaceAccountAccess SharedWorkspaceAccountAccess[]

  // Timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Indexes & Constraints
}

model SharedWorkspaceAccountAccess {
  // Primary Key
  id String @id @default(cuid())

  // Foreign Keys
  workspaceAccountId String
  userId             String
  assignerId         String

  // Fields
  metadata Json?

  // Enums
  role   WORKSPACE_ACCOUNT_ACCESS_ROLE   @default(MEMBER)
  status WORKSPACE_ACCOUNT_ACCESS_STATUS @default(ACTIVE)

  // Relations
  workspaceAccount      WorkspaceAccount      @relation(fields: [workspaceAccountId], references: [id], onDelete: Cascade)
  releases              Release[]
  tracks                Track[]
  videos                Video[]
  ringtones             Ringtone[]
  artists               Artist[]
  performers            Performer[]
  producersAndEngineers ProducerAndEngineer[]
  writers               Writer[]
  publishers            Publisher[]
  labels                Label[]
  user                  User                  @relation(name: "SharedWorkspaceAccountAccessUser", fields: [userId], references: [id], onDelete: Cascade)
  assigner              User                  @relation(name: "SharedWorkspaceAccountAccessAssigner", fields: [assignerId], references: [id], onDelete: Cascade)

  // Timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Indexes & Constraints
}

model Transaction {
  // Primary Key
  id String @id @default(cuid())

  // Foreign Keys

  // Fields
  metadata Json?

  // Enums

  // Relations

  // Timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Indexes & Constraints
}

model Withdrawal {
  // Primary Key
  id String @id @default(cuid())

  // Foreign Keys

  // Fields
  metadata Json?

  // Enums

  // Relations

  // Timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Indexes & Constraints
}

model AuditLog {
  // Primary Key
  id String @id @default(cuid())

  // Foreign Keys
  userId String?

  // Fields
  entityId    String?
  bySystem    Boolean @default(false)
  description String?
  metadata    Json?

  // Enums
  action AUDIT_LOG_ACTION
  entity AUDIT_LOG_ENTITY

  // Relations
  user User? @relation(fields: [userId], references: [id], onDelete: SetNull)

  // Timestamps
  createdAt DateTime @default(now())

  // Indexes & Constraints
}
